@if(uiElement) {
  {{log()}}
  <div class="flex flex-column">
    <ion-searchbar mode="ios" show-clear-button="always"></ion-searchbar>
    <ul class="tree">
      <li>
        @if(uiElement.children && Object.keys(uiElement.children).length > 0) {
          @if(uiElement.htmlAttributes && uiElement.htmlAttributes['open'] ) {
            <ion-icon (click)="collapse(uiElement, false)" class="icon-collapse text-2xl cursor-pointer" name="chevron-down-circle" ></ion-icon>
          } @else {
            <ion-icon (click)="collapse(uiElement, true)" class="icon-collapse text-2xl cursor-pointer" name="chevron-forward-circle" ></ion-icon>
          }

          <div class="details" >
            <div class="summary " >
              {{uiElement.label}}</div>
            @if(uiElement.htmlAttributes && uiElement.htmlAttributes['open'] ) {
              <ul>
                @for( item of uiElement.children | keyvalue:  orderOriginal; track item ) {
                  <li>
                    <ng-container
                      *ngTemplateOutlet="inner; context: { children: item.value }">
                    </ng-container>
                  </li>
                }
              </ul>
            }
          </div>
        } @else {
          {{uiElement.label}}
        }
      </li>
    </ul>
    <ng-template #inner let-children="children">
      @if(children.children && Object.keys(children.children).length > 0) {
        @if(children.htmlAttributes && children.htmlAttributes['open'] ) {
          <ion-icon (click)="collapse(children, false)" class="icon-collapse text-2xl cursor-pointer" name="chevron-down-circle" ></ion-icon>
        } @else {
          <ion-icon (click)="collapse(children, true)" class="icon-collapse text-2xl cursor-pointer" name="chevron-forward-circle" ></ion-icon>
        }
        <div class="details">
          <div class="group ">
            <div class="flex items-center cursor-pointer summary">
              {{children.label}}
              <ion-icon (click)="removeNode(children)"  name="trash-outline" class="hidden group-hover:flex ml-2 text-2xl cursor-pointer"></ion-icon>
            </div>
            <div (click)="presentPopover(children ,$event)" class="hidden group-hover:flex items-center cursor-pointer">
              <ion-icon name="add-circle" class="mr-2 text-2xl"></ion-icon>
              <div >Thêm thành phần</div>
            </div>
          </div>
          @if(children.htmlAttributes && children.htmlAttributes['open'] ) {
            <ul >
              @for( item of children.children | keyvalue:  orderOriginal; track item ) {
                <li>
                  <ng-container
                    *ngTemplateOutlet="inner; context: { children: item.value }">
                  </ng-container>
                </li>
              }
            </ul>
          }
        </div>
      } @else {

        @if(children.children) {
          <div class="group ">
            <!-- Thẻ chính -->
            <div class="flex items-center cursor-pointer summary">
              {{children.label}}
              <ion-icon (click)="removeNode(children)" name="trash-outline" class="hidden group-hover:flex ml-2 text-2xl cursor-pointer"></ion-icon>
            </div>
            <!-- Thẻ hiển thị khi hover -->
            <div (click)="presentPopover(children,$event)" class="hidden group-hover:flex items-center cursor-pointer">
              <ion-icon name="add-circle" class="mr-2 text-2xl"></ion-icon>
              <div >Thêm thành phần</div>
            </div>
          </div>
        } @else {
          <div class="group flex items-center cursor-pointer">
            {{children.label}}
            <ion-icon (click)="removeNode(children)"  name="trash-outline" class="hidden group-hover:flex ml-2 text-2xl cursor-pointer"></ion-icon>
          </div>

        }
      }
    </ng-template>
  </div>

}


